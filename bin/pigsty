#!/usr/bin/env node

var pigsty = require('../lib/pigsty');
var argv = require('optimist').argv;
var cli = require('../lib/pigsty/cli');

cli.init();


// Pigsty - The best unfiied2 spooler

    // -l, --logs
    // -C, --classification-conf - Classification.conf
    // -R, --references-conf - refrences.conf
    // -S, --sig-map - sig-map
    // -G, --gen-map - gen map
    // -i, --interfaces
    // -c, --config - pigsty configuration file
    // -p, --plugins - mysql:::host=127.0.0.1;port=8080;ssl=true;password="word" postgres:::host=""


var Spooler = require('../lib/pigsty/spooler');
var fs = require('fs');
var path = require('path');

if (!fs.existsSync(path.join(__dirname, '../config/pigsty.config.js'))) {
  console.error("[!] Configuration file config/pigsty.config.js is missing.");
  process.exit(1);
};

var config = require('../config/pigsty.config')

var spooler = new Spooler(config);
spooler.start();

process.on('SIGINT', function() {
  spooler.stop();
  process.exit(0);
})

process.on('SIGTERM', function() {
  spooler.stop();
  process.exit(0);
})



